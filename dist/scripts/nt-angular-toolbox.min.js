/*! nt-angular-toolbox - v0.4.0 - 2015-02-16
* Copyright (c) 2015 Williams Torres (wtorres@nectia.com); Licensed MIT */
(function(){
!function(){"use strict";function a(a){return{restrict:"E",transclude:!0,template:a.getConfiguration().template,replace:!0}}function b(a){function b(b,c){c.html(b.template),a(c.contents())(b.controller)}return{restrict:"A",replace:!0,scope:{template:"@ntModalTemplate",controller:"@"},link:b}}function c(a,b,c){function d(){return'<div data-tool="tablePagination"><ul class="tp-quantity-selector"><li><a ng-class="{active: nroRows == 100}" ng-click="changePagination(100)" data-quantity="100">100</a></li><li><a ng-class="{active: nroRows == 50}" ng-click="changePagination(50)" data-quantity="50">50</a></li><li><a ng-class="{active: nroRows == 10}" ng-click="changePagination(10)" data-quantity="10">10</a></li></ul><ul class="tp-page-navigator"><li><a ng-click="nextPage()" data-action="tablePageForward" data-icon="table-nav-right"></a></li><li><a ng-click="previousPage()" data-action="tablePageBackward" data-icon="table-nav-left"></a></li></ul><span class="tp-page-indicator"> {{actualPage}} / {{totalPages}} </span></div>'}function e(b,e,f){f.templateUrl?c(f.templateUrl,!0).then(function(c){e.html(c),a(e.contents())(b)},function(){throw"Error al cargar el template: "+f.templateUrl}):(e.html(d()),a(e.contents())(b))}function f(a){a.changePagination=function(c){a.nroRows!==c&&b(function(){a.nroRows=c,a.$apply(),a.load()})},a.nextPage=function(){a.actualPage<a.totalPages&&b(function(){a.actualPage++,a.$apply(),a.load()})},a.previousPage=function(){a.actualPage>1&&b(function(){a.actualPage--,a.$apply(),a.load()})}}return{restrict:"E",scope:{actualPage:"=",totalPages:"=",nroRows:"=",load:"&"},replace:!0,link:e,controller:f}}function d(){function a(){var a=angular.element(c.configuration.template);a.attr("ng-transclude",""),c.configuration.template=a[0].outerHTML}function b(a,b,f,g,h,i){function j(a){a.scope.$destroy(),a.modal.remove(),d.splice(d.indexOf(a),1),h.hide(),0===d.length&&(c.zIndex=c.configuration.initiaIndex)}return{open:function(k){var l=angular.element(document.createElement("nt-modal"));l.append(k.template),h.show(c.zIndex+1),c.zIndex=c.zIndex+2,l.css("z-index",c.zIndex);var m=g.$new();a(l)(m);var n=new e(b,m,l,j);d.push(n);var o=angular.extend({},k.resolve);return angular.forEach(o,function(a,b){o[b]=angular.isString(a)?i.get(a):i.invoke(a,null,null,b)}),b.all(o).then(function(){f(k.controller,angular.extend({$scope:m,modalInstance:n.service},o)),angular.element(document.body).append(l)}),n.getPromise()},destroyModal:j,getConfiguration:function(){return c.configuration}}}var c=this,d=[];this.configuration={initiaIndex:1e3,template:'<div class="modal"></div>'},a(),this.setConfig=function(b){angular.extend(this.configuration,b),this.configuration.templateUrl||a(),this.zIndex=this.configuration.initiaIndex},this.zIndex=this.configuration.initiaIndex,b.$inject=["$compile","$q","$controller","$rootScope","ntOverlayService","$injector"],this.$get=b}function e(a,b,c,d){var e=this,f=a.defer();this.scope=b,this.modal=c,this.service={resolve:function(a){d(e),f.resolve(a)},reject:function(a){d(e),f.reject(a)}},this.getPromise=function(){return f.promise}}function f(){function a(){b.css("z-index",c[c.length-1])}var b,c=[];this.show=function(d){void 0===b&&(b=angular.element(document.createElement("div")),b.addClass("palette-overlay"),angular.element(document.body).append(b)),c.push(d),a()},this.hide=function(){c.pop(),0===c.length?(b.remove(),b=void 0):a()}}var g=angular.module("nt.angular.toolbox",[]);a.$inject=["ntModalService"],g.directive("ntModal",a),b.$inject=["$compile"],g.directive("ntModalTemplate",b),c.$inject=["$compile","$timeout","$templateRequest"],g.directive("ntPagination",c),g.provider("ntModalService",d),g.service("ntOverlayService",f)}();